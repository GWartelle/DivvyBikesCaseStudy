library(tidyverse)
library(skimr)
library(RANN)
library(patchwork)
library(RColorBrewer)
library(tibble)
work_theme <- theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
processed_data %>%
mutate(member_casual = fct_relevel(member_casual, "member", "casual"))  %>%
count(week, member_casual) %>%
ggplot(mapping = aes(x = week, y = n, fill = member_casual)) +
geom_area(alpha = 0.6, color = 2, position = position_dodge(width=0)) +
labs(title = "Member vs. Casual Rides over a Year",
x = "Months",
y = "Number of Rides") +
scale_x_continuous(breaks = seq(from = 2, to = 52, by = 4.5),
labels=c('Jan','Fév','Mar','Avr','Mai','Juin',
'Juil','Aoû','Sep','Oct','Nov','Déc')) +
scale_fill_manual(values = c("member" = "your_member_color", "casual" = "your_casual_color")) +
work_theme
processed_data %>%
mutate(member_casual = fct_relevel(member_casual, "member", "casual"))  %>%
count(week, member_casual) %>%
ggplot(mapping = aes(x = week, y = n, fill = member_casual)) +
geom_area(alpha = 0.6, color = 2, position = position_dodge(width=0)) +
labs(title = "Member vs. Casual Rides over a Year",
x = "Months",
y = "Number of Rides") +
scale_x_continuous(breaks = seq(from = 2, to = 52, by = 4.5),
labels=c('Jan','Fév','Mar','Avr','Mai','Juin',
'Juil','Aoû','Sep','Oct','Nov','Déc')) +
scale_fill_manual(values = c("member" = "#619CFF", "casual" = "#F8766D")) +
work_theme
processed_data %>%
mutate(member_casual = fct_relevel(member_casual, "member", "casual"))  %>%
count(week, member_casual) %>%
ggplot(mapping = aes(x = week, y = n, fill = member_casual)) +
geom_area(alpha = 0.6, color = 2, position = position_dodge(width=0)) +
labs(title = "Member vs. Casual Rides over a Year",
x = "Months",
y = "Number of Rides") +
scale_x_continuous(breaks = seq(from = 2, to = 52, by = 4.5),
labels=c('Jan','Fév','Mar','Avr','Mai','Juin',
'Juil','Aoû','Sep','Oct','Nov','Déc')) +
scale_fill_manual(values = c("member" = "#00BFC4", "casual" = "#F8766D")) +
work_theme
processed_data %>%
mutate(member_casual = fct_relevel(member_casual, "member", "casual"))  %>%
count(week, member_casual) %>%
ggplot(mapping = aes(x = week, y = n, fill = member_casual)) +
geom_area(alpha = 0.6, color = 2, position = position_dodge(width=0)) +
labs(title = "Member vs. Casual Rides over a Year",
x = "Months",
y = "Number of Rides") +
scale_x_continuous(breaks = seq(from = 2, to = 52, by = 4.5),
labels=c('Jan','Feb','Mar','Apr','May','Jun',
'Jul','Aug','Sep','Oct','Nov','Dec')) +
scale_fill_manual(values = c("member" = "#00BFC4", "casual" = "#F8766D")) +
work_theme
processed_data %>%
group_by(week, member_casual) %>%
summarise(mean_duration = mean(trip_duration)) %>%
ggplot(mapping = aes(x = week, y = mean_duration, fill = member_casual)) +
scale_color_brewer(palette = "Dark2") +
geom_area(alpha = 0.6, color = 2, position = position_dodge(width=0)) +
labs(title = "Member vs. Casual Trip duration over the year",
x = "Month of the year",
y = "Trip duration in minutes") +
scale_x_continuous(breaks = seq(from = 2, to = 52, by = 4.5),
labels=c('Jan','Feb','Mar','Apr','May','Jun',
'Jul','Aug','Sep','Oct','Nov','Dec')) +
work_theme +
scale_fill_brewer(palette = "Dark2")
#Creating a scatter plot to represent the correlation between trip duration and ride distance
processed_data %>%
count(trip_duration, distance, member_casual, rideable_type) %>%
ggplot(mapping = aes(x = trip_duration, y = distance, color = rideable_type)) +
geom_jitter(alpha = 0.5) +
geom_smooth() +
labs(title = "Member vs. Casual ride distance over trip_duration",
x = "Trip duration in minutes",
y = "Trip distance in meters") +
facet_wrap(facets = vars(member_casual)) +
work_theme
# Creating a datasets to work with in the Tableau software
ride_count <- processed_data %>%
count(start_lat, start_lng, member_casual, rideable_type)
ride_duration <- processed_data %>%
group_by(start_lat, start_lng, member_casual) %>%
summarise(mean_duration = round(mean(trip_duration)))
ride_distance <- processed_data %>%
group_by(start_lat, start_lng, member_casual) %>%
summarise(mean_distance = round(mean(distance)))
write.csv(ride_count, file = "./Output/Data/ride_count.csv", row.names = FALSE)
write.csv(ride_duration, file = "./Output/Data/ride_duration.csv", row.names = FALSE)
write.csv(ride_distance, file = "./Output/Data/ride_distance.csv", row.names = FALSE)
library(tidyverse)
library(skimr)
library(RANN)
library(patchwork)
library(RColorBrewer)
library(tibble)
library(tidyverse)
library(skimr)
library(RANN)
library(patchwork)
library(RColorBrewer)
library(tibble)
processed_data <- readRDS(file = "Output/Data/processed_data.rds")
work_theme <- theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
processed_data %>%
count(member_casual) %>%
pivot_wider(names_from = member_casual, values_from = n)
member_rideable <- processed_data %>%
filter(member_casual == "member") %>%
count(rideable_type) %>%
ggplot(mapping = aes(x ="", y = n, fill=rideable_type)) +
geom_bar(stat = "identity", width = 1, color="white") +
scale_fill_manual(values = c("classic_bike"="#F8766D",
"electric_bike"="#619CFF")) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Member rideables") +
theme(plot.title = element_text(hjust = 0.5))
casual_rideable <- processed_data %>%
filter(member_casual == "casual") %>%
count(rideable_type) %>%
ggplot(mapping = aes(x ="", y = n, fill=rideable_type)) +
geom_bar(stat = "identity", width = 1, color="white") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Casual rideables") +
theme(plot.title = element_text(hjust = 0.5))
rideable_usage <- (member_rideable + casual_rideable) +
plot_annotation(title = "Member vs. Casual rideables usage",
theme = theme(plot.title = element_text(hjust = 0.4)))
rideable_usage
processed_data %>%
group_by(rideable_type, member_casual) %>%
summarise(mean_duration = mean(trip_duration)) %>%
ggplot(mapping = aes(x = rideable_type, y = as.numeric(mean_duration), fill = rideable_type)) +
geom_bar(stat = "identity") +
labs(title = "Member vs. Casual Trip duration per Rideable type",
x = "Rideable type",
y = "Average trip duration (in minutes)",
fill = "Rideable type") +
work_theme +
coord_flip() +
facet_grid(rows = vars(member_casual))
processed_data %>%
group_by(rideable_type, member_casual) %>%
summarise(mean_distance = mean(distance)) %>%
ggplot(mapping = aes(x = rideable_type, y = mean_distance, fill = rideable_type)) +
geom_bar(stat = "identity") +
labs(title = "Member vs. Casual distance between stations per rideable type",
x = "Rideable type",
y = "Average distance between start and end stations (in meters)",
fill = "Rideable type") +
work_theme +
coord_flip() +
facet_grid(rows = vars(member_casual))
processed_data %>%
select(start_station_name, end_station_name) %>%
gather(key = "station_id", value = "station_name",
start_station_name:end_station_name) %>%
cbind(member_casual = processed_data$member_casual) %>%
group_by(station_name, member_casual) %>%
summarise(count = n()) %>%
arrange(member_casual, desc(count)) %>%
group_by(member_casual) %>%
top_n(5, count) %>%
ggplot(mapping = aes(x = reorder(station_name, desc(count)),
y = count, fill = station_name)) +
geom_col() +
labs(title = "Member vs. Casual Favorite stations",
x = "Station names",
y = "Number if times used",
fill = "Station names") +
work_theme +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_wrap(facets = vars(member_casual), scales = "free_x")
processed_data %>%
group_by(member_casual) %>%
summarise(mean_duration = mean(trip_duration)) %>%
pivot_wider(names_from = member_casual, values_from = mean_duration)
processed_data %>%
ggplot(mapping = aes(x = trip_duration, fill = rideable_type)) +
geom_bar() +
labs(title = "Member vs. Casual Trip duration",
x = "Trip Duration in minutes",
y = "Number of Rides") +
work_theme +
facet_grid(rows = vars(member_casual))
processed_data %>%
mutate("trip_dur_per10" =
ifelse(trip_duration<10, "0-10",
ifelse(trip_duration>=10 & trip_duration<20, "10-20",
ifelse(trip_duration>=20 & trip_duration<30, "20-30",
ifelse(trip_duration>=30 & trip_duration<40, "30-40",
ifelse(trip_duration>=40 & trip_duration<50, "40-50","50+")))))) %>%
ggplot(mapping = aes(x = trip_dur_per10, fill = rideable_type)) +
geom_bar() +
labs(title = "Member vs. Casual Trip duration",
x = "Trip Duration in minutes",
y = "Number of Rides") +
work_theme +
facet_grid(rows = vars(member_casual))
# Creating a bar graph to represent the number of rides per group of trip distance
processed_data %>%
mutate("trip_dist_per_km" =
ifelse(distance<1000, "0-1km",
ifelse(distance>=1000 & distance<2000, "1-2km",
ifelse(distance>=2000 & distance<3000, "2-3km",
ifelse(distance>=3000 & distance<4000, "3-4km",
ifelse(distance>=4000 & distance<5000, "4-5km","5km+")))))) %>%
ggplot(mapping = aes(x = trip_dist_per_km, fill = rideable_type)) +
geom_bar() +
labs(title = "Member vs. Casual Trip distance",
x = "Trip distance in kilometers",
y = "Number of Rides") +
work_theme +
facet_grid(rows = vars(member_casual))
processed_data %>%
count(hour, member_casual) %>%
mutate("daily_mean" = n/365) %>%
ggplot(mapping = aes(x = hour, y = daily_mean, fill = member_casual)) +
geom_col(position = "dodge") +
labs(title = "Member vs. Casual Starting Rides per hour",
x = "Hour of the day",
y = "Number of Rides") +
work_theme
processed_data %>%
group_by(hour, member_casual) %>%
summarise(mean_duration = mean(trip_duration)) %>%
ggplot(mapping = aes(x = hour, y = mean_duration, fill = member_casual)) +
geom_col(position = "dodge") +
labs(title = "Member vs. Casual Trip duration per hour",
x = "Hours of the day",
y = "Trip duration in minutes") +
work_theme +
scale_fill_brewer(palette = "Dark2")
processed_data %>%
count(hour, week_day, member_casual) %>%
mutate("daily_mean" = n/365) %>%
ggplot(mapping = aes(x = hour, y = daily_mean, fill = member_casual)) +
geom_col(position = "dodge") +
labs(title = "Member vs. Casual Daily Trips per Hour over the Week",
x = "Hour of the day",
y = "Number of Rides") +
work_theme +
facet_wrap(vars(week_day))
processed_data %>%
count(week_day, member_casual) %>%
mutate("weekly_mean" = n/52) %>%
ggplot(mapping = aes(x = week_day, y = weekly_mean, fill = member_casual)) +
geom_col(position = "dodge") +
labs(title = "Member vs. Casual Rides over a week",
x = "Day of the week",
y = "Average Number of Rides") +
work_theme
processed_data %>%
group_by(week_day, member_casual) %>%
summarise(mean_duration = mean(trip_duration)) %>%
ggplot(mapping = aes(x = week_day, y = mean_duration, fill = member_casual)) +
geom_col(position = "dodge") +
labs(title = "Member vs. Casual Trip duration over a week",
x = "Days of the week",
y = "Trip duration in minutes") +
work_theme +
scale_fill_brewer(palette = "Dark2")
processed_data %>%
mutate(member_casual = fct_relevel(member_casual, "member", "casual"))  %>%
count(week, member_casual) %>%
ggplot(mapping = aes(x = week, y = n, fill = member_casual)) +
geom_area(alpha = 0.6, color = 2, position = position_dodge(width=0)) +
labs(title = "Member vs. Casual Rides over a Year",
x = "Months",
y = "Number of Rides") +
scale_x_continuous(breaks = seq(from = 2, to = 52, by = 4.5),
labels=c('Jan','Feb','Mar','Apr','May','Jun',
'Jul','Aug','Sep','Oct','Nov','Dec')) +
scale_fill_manual(values = c("member" = "#00BFC4", "casual" = "#F8766D")) +
work_theme
processed_data %>%
group_by(week, member_casual) %>%
summarise(mean_duration = mean(trip_duration)) %>%
ggplot(mapping = aes(x = week, y = mean_duration, fill = member_casual)) +
scale_color_brewer(palette = "Dark2") +
geom_area(alpha = 0.6, color = 2, position = position_dodge(width=0)) +
labs(title = "Member vs. Casual Trip duration over the year",
x = "Month of the year",
y = "Trip duration in minutes") +
scale_x_continuous(breaks = seq(from = 2, to = 52, by = 4.5),
labels=c('Jan','Feb','Mar','Apr','May','Jun',
'Jul','Aug','Sep','Oct','Nov','Dec')) +
work_theme +
scale_fill_brewer(palette = "Dark2")
library(tidyverse)
library(skimr)
library(RANN)
library(patchwork)
library(RColorBrewer)
library(tibble)
processed_data <- readRDS(file = "Output/Data/processed_data.rds")
work_theme <- theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
processed_data %>%
count(member_casual) %>%
pivot_wider(names_from = member_casual, values_from = n)
member_rideable <- processed_data %>%
filter(member_casual == "member") %>%
count(rideable_type) %>%
ggplot(mapping = aes(x ="", y = n, fill=rideable_type)) +
geom_bar(stat = "identity", width = 1, color="white") +
scale_fill_manual(values = c("classic_bike"="#F8766D",
"electric_bike"="#619CFF")) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Member rideables") +
theme(plot.title = element_text(hjust = 0.5))
casual_rideable <- processed_data %>%
filter(member_casual == "casual") %>%
count(rideable_type) %>%
ggplot(mapping = aes(x ="", y = n, fill=rideable_type)) +
geom_bar(stat = "identity", width = 1, color="white") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Casual rideables") +
theme(plot.title = element_text(hjust = 0.5))
rideable_usage <- (member_rideable + casual_rideable) +
plot_annotation(title = "Member vs. Casual rideables usage",
theme = theme(plot.title = element_text(hjust = 0.4)))
rideable_usage
processed_data %>%
group_by(rideable_type, member_casual) %>%
summarise(mean_duration = mean(trip_duration)) %>%
ggplot(mapping = aes(x = rideable_type, y = as.numeric(mean_duration), fill = rideable_type)) +
geom_bar(stat = "identity") +
labs(title = "Member vs. Casual Trip duration per Rideable type",
x = "Rideable type",
y = "Average trip duration (in minutes)",
fill = "Rideable type") +
work_theme +
coord_flip() +
facet_grid(rows = vars(member_casual))
processed_data %>%
group_by(rideable_type, member_casual) %>%
summarise(mean_distance = mean(distance)) %>%
ggplot(mapping = aes(x = rideable_type, y = mean_distance, fill = rideable_type)) +
geom_bar(stat = "identity") +
labs(title = "Member vs. Casual distance between stations per rideable type",
x = "Rideable type",
y = "Average distance between start and end stations (in meters)",
fill = "Rideable type") +
work_theme +
coord_flip() +
facet_grid(rows = vars(member_casual))
processed_data %>%
select(start_station_name, end_station_name) %>%
gather(key = "station_id", value = "station_name",
start_station_name:end_station_name) %>%
cbind(member_casual = processed_data$member_casual) %>%
group_by(station_name, member_casual) %>%
summarise(count = n()) %>%
arrange(member_casual, desc(count)) %>%
group_by(member_casual) %>%
top_n(5, count) %>%
ggplot(mapping = aes(x = reorder(station_name, desc(count)),
y = count, fill = station_name)) +
geom_col() +
labs(title = "Member vs. Casual Favorite stations",
x = "Station names",
y = "Number if times used",
fill = "Station names") +
work_theme +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_wrap(facets = vars(member_casual), scales = "free_x")
processed_data %>%
group_by(member_casual) %>%
summarise(mean_duration = mean(trip_duration)) %>%
pivot_wider(names_from = member_casual, values_from = mean_duration)
processed_data %>%
ggplot(mapping = aes(x = trip_duration, fill = rideable_type)) +
geom_bar() +
labs(title = "Member vs. Casual Trip duration",
x = "Trip Duration in minutes",
y = "Number of Rides") +
work_theme +
facet_grid(rows = vars(member_casual))
processed_data %>%
mutate("trip_dur_per10" =
ifelse(trip_duration<10, "0-10",
ifelse(trip_duration>=10 & trip_duration<20, "10-20",
ifelse(trip_duration>=20 & trip_duration<30, "20-30",
ifelse(trip_duration>=30 & trip_duration<40, "30-40",
ifelse(trip_duration>=40 & trip_duration<50, "40-50","50+")))))) %>%
ggplot(mapping = aes(x = trip_dur_per10, fill = rideable_type)) +
geom_bar() +
labs(title = "Member vs. Casual Trip duration",
x = "Trip Duration in minutes",
y = "Number of Rides") +
work_theme +
facet_grid(rows = vars(member_casual))
# Creating a bar graph to represent the number of rides per group of trip distance
processed_data %>%
mutate("trip_dist_per_km" =
ifelse(distance<1000, "0-1km",
ifelse(distance>=1000 & distance<2000, "1-2km",
ifelse(distance>=2000 & distance<3000, "2-3km",
ifelse(distance>=3000 & distance<4000, "3-4km",
ifelse(distance>=4000 & distance<5000, "4-5km","5km+")))))) %>%
ggplot(mapping = aes(x = trip_dist_per_km, fill = rideable_type)) +
geom_bar() +
labs(title = "Member vs. Casual Trip distance",
x = "Trip distance in kilometers",
y = "Number of Rides") +
work_theme +
facet_grid(rows = vars(member_casual))
library(tidyverse)
library(skimr)
library(RANN)
library(patchwork)
library(RColorBrewer)
library(tibble)
processed_data <- readRDS(file = "Output/Data/processed_data.rds")
col(processed_data)
colums(processed_data)
names(processed_data)
colnames(processed_data)
install.packages(tidyverse)
install.packages(skimr)
install.packages(RANN)
install.packages(patchwork)
install.packages(RColorBrewer)
install.packages(tibble)
library(tidyverse)
library(skimr)
library(RANN)
library(patchwork)
library(RColorBrewer)
library(tibble)
install.packages(tidyverse)
install.packages(skimr)
install.packages(RANN)
install.packages(patchwork)
install.packages(RColorBrewer)
install.packages(tibble)
if (!requireNamespace("tidyverse", quietly = TRUE)) install.packages("tidyverse")
if (!requireNamespace("skimr", quietly = TRUE)) install.packages("skimr")
if (!requireNamespace("RANN", quietly = TRUE)) install.packages("RANN")
if (!requireNamespace("patchwork", quietly = TRUE)) install.packages("patchwork")
if (!requireNamespace("RColorBrewer", quietly = TRUE)) install.packages("RColorBrewer")
if (!requireNamespace("tibble", quietly = TRUE)) install.packages("tibble")
library(tidyverse)
library(skimr)
library(RANN)
library(patchwork)
library(RColorBrewer)
library(tibble)
# Creating a chart showing the differences in average ride distances
processed_data %>%
group_by(rideable_type, member_casual) %>%
summarise(mean_distance = mean(distance)) %>%
ggplot(mapping = aes(x = rideable_type, y = mean_distance, fill = rideable_type)) +
geom_bar(stat = "identity") +
labs(title = "Member vs. Casual distance between stations per rideable type",
x = "Rideable type",
y = "Average distance between start and end stations (in meters)",
fill = "Rideable type") +
work_theme +
coord_flip() +
facet_grid(rows = vars(member_casual))
# Updating needed R packages
if (!requireNamespace("tidyverse", quietly = TRUE)) install.packages("tidyverse")
if (!requireNamespace("skimr", quietly = TRUE)) install.packages("skimr")
if (!requireNamespace("RANN", quietly = TRUE)) install.packages("RANN")
if (!requireNamespace("patchwork", quietly = TRUE)) install.packages("patchwork")
if (!requireNamespace("RColorBrewer", quietly = TRUE)) install.packages("RColorBrewer")
if (!requireNamespace("tibble", quietly = TRUE)) install.packages("tibble")
# Loading needed R packages
library(tidyverse)
library(skimr)
library(RANN)
library(patchwork)
library(RColorBrewer)
library(tibble)
processed_data <- readRDS(file = "Output/Data/processed_data.rds")
# Creating a theme for visualizations
work_theme <- theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
# Creating a bar graph representing the most used stations over the year
processed_data %>%
select(start_station_name, end_station_name) %>%
gather(key = "station_id", value = "station_name",
start_station_name:end_station_name) %>%
cbind(member_casual = processed_data$member_casual) %>%
group_by(station_name, member_casual) %>%
summarise(count = n()) %>%
arrange(member_casual, desc(count)) %>%
group_by(member_casual) %>%
top_n(5, count) %>%
ggplot(mapping = aes(x = reorder(station_name, desc(count)),
y = count, fill = station_name)) +
geom_col() +
labs(title = "Member vs. Casual Favorite stations",
x = "Station names",
y = "Times used") +
work_theme +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_wrap(facets = vars(member_casual), scales = "free_x")
